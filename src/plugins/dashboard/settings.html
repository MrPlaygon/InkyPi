<div class="form-group">
    <label for="lat" class="form-label">Lat:</label>
    <input type="text" id="lat" name="lat" class="form-input" />

    <label for="long" class="form-label">Long:</label>
    <input type="text" id="long" name="long" class="form-input" />
</div>

<script>
    document.addEventListener('DOMContentLoaded', () => {
        const latInputElement = document.getElementById("lat");
        const longInputElement = document.getElementById("long");

        if (pluginSettings && pluginSettings.lat) {
            latInputElement.value = pluginSettings.lat;
        }
        if (pluginSettings && pluginSettings.long) {
            longInputElement.value = pluginSettings.long;
        }
    });
</script>

<div class="form-group">
    <label for="calendar_future_days" class="form-label">Future Calendar Days:</label>
    <input type="number" id="calendar_future_days" name="calendar_future_days" class="form-input" />
</div>

<script>
    document.addEventListener('DOMContentLoaded', () => {
        const calDaysInputElement = document.getElementById("calendar_future_days");

        if (pluginSettings && pluginSettings.calendar_future_days) {
            calDaysInputElement.value = pluginSettings.calendar_future_days;
        }
    });
</script>

<div>
  <label class="form-label">Calendars:</label>
  <div id="calendarList"></div>
  <button type="button" id="addCalendarBtn" class="form-input collapsible" onclick="addCalendarInput('', '#007BFF')">Add Calendar</button>
</div>

<script>
    function addCalendarInput(url = '', color = '#007BFF') {
        const calendarList = document.getElementById('calendarList');

        const wrapper = document.createElement('div');
        wrapper.classList.add('calendar-entry');
        wrapper.classList.add('form-group');

        const colorInput = document.createElement('input');
        colorInput.type = 'color';
        colorInput.name = 'calendarColors[]';
        colorInput.classList.add('color-picker');
        colorInput.value = color;

        const urlInput = document.createElement('input');
        urlInput.type = 'text';
        urlInput.name = 'calendarURLs[]';
        urlInput.placeholder = 'Calendar URL';
        urlInput.required = true;
        urlInput.classList.add('form-input');
        urlInput.value = url;

        const removeBtn = document.createElement('button');
        removeBtn.type = 'button';
        removeBtn.innerText = 'âœ•';
        removeBtn.classList.add('remove-btn');
        removeBtn.onclick = () => wrapper.remove();

        wrapper.appendChild(colorInput);
        wrapper.appendChild(urlInput);
        wrapper.appendChild(removeBtn);

        calendarList.appendChild(wrapper);
    }

    // populate form values from plugin settings
    document.addEventListener('DOMContentLoaded', () => {
        let calendars = [{ url: '', color: '#007BFF' }];

        if (loadPluginSettings) {
            if (pluginSettings["calendarURLs[]"]) {
                calendars = pluginSettings["calendarURLs[]"].map((url, i) => ({
                    url: url || '',
                    color: pluginSettings["calendarColors[]"][i]  || '#007BFF'
                }));
            }
        }

        // populate calendars
        calendars.forEach(({ url, color }) => {
            addCalendarInput(url, color);
        });
    });

</script>